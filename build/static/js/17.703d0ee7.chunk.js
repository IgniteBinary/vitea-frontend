(this["webpackJsonpmerchant-portal-v2"]=this["webpackJsonpmerchant-portal-v2"]||[]).push([[17],{1195:function(e,t,a){},1612:function(e,t,a){"use strict";a.r(t),a.d(t,"ExpiredSubscription",(function(){return R})),a.d(t,"mapDispatchToProps",(function(){return q})),a.d(t,"mapStateToProps",(function(){return z}));var n=a(1),r=a(63),i=a(64),o=a(66),s=a(65),c=a(0),l=a.n(c),u=a(2784),p=a(1655),d=a(34),h=a(216),m=a.n(h),f=a(219),g=a(69),b=a(68),v=a(1614),y=a(1298),O=a(1299),E=a(908),w=a(1300),N=(a(391),a(340)),k=a(310),j=a(412),C=a(204),S=a.n(C),x=a(3),I=a(212),_=function(e){return function(t){t({type:"START_MAKE_PAYMENTS"});var a=JSON.parse(localStorage.getItem("user")),n=a._id,r=a.merchant_id;return console.log(n),S.a.post("https://gateway.julla.co/merchant/v1/merchants/".concat(r,"/renew-subscription"),e).then((function(e){var a;t((a=e.data,{type:x.eb,payload:a}))})).catch((function(e){var a;console.log(e),b.f.error(e.response.data.message),t((a=e,{type:x.db,payload:a}))}))}},P=function(){return function(e){e(Object(I.a)());JSON.parse(localStorage.getItem("user")).merchant_id;return S.a.get("https://gateway.julla.co/merchant/v1/subscriptions").then((function(t){var a;e((a=t.data,{type:x.Q,payload:a})),localStorage.setItem("subscription",JSON.stringify(t.data))})).catch((function(t){var a;b.f.error(t.response.data.message),e((a=t,{type:x.P,payload:a}))}))}},D=(a(242),a(1195),a(266)),M=a(107),T=a.n(M),V=function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var i;return Object(r.a)(this,a),(i=t.call(this,e)).handleInputChange=function(e){e.preventDefault();var t={type:e.target.name,content:e.target.value},a=Object(k.a)(t,i.state.error),r=i.state.user;console.log(i.state),i.setState({user:Object(n.a)(Object(n.a)({},r),{},Object(g.a)({},e.target.name,e.target.value)),error:a})},i.handleSubmit=function(){var e=Object(f.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=i.props.pay,n=i.state.error,!(Object.keys(n).length>0)){e.next=6;break}return b.f.error("Invalid Fields",{position:b.f.POSITION.TOP_RIGHT}),e.abrupt("return",!1);case 6:return e.next=8,a(i.state.user);case 8:i.props.Subscription.success&&(b.f.success("Payment request initiated successfully kindly confirm the MPESA payment pop up request",{position:b.f.POSITION.TOP_RIGHT}),i.props.toggle());case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.hasError=function(){return Object.keys(i.state.error).length>0},i.state={hasErrors:null,backdrop:!0,error:{},user:{subscription_mode:"",subscription_id:""}},i}return Object(i.a)(a,[{key:"render",value:function(){this.state.error,JSON.parse(localStorage.getItem("stores"));var e=this.props.subs,t=l.a.createElement("button",{className:"close",type:"submit",onClick:this.props.toggle},"\xd7");return l.a.createElement("span",{className:"d-inline-block mb-2 mr-2 create-user-modal"},l.a.createElement(b.d,null),l.a.createElement(v.a,{isOpen:this.props.modal,toggle:this.props.toggle,className:this.props.className,backdrop:this.state.backdrop},l.a.createElement(y.a,{toggle:this.toggle,close:t},"Make Payments"),l.a.createElement(O.a,null,l.a.createElement(E.a,{onSubmit:this.handleSubmit},this.state.hasErrors&&l.a.createElement("div",null,"Invalid Inputs"),l.a.createElement(N.a,{classes:"create-user-input",label:"Subscription Type",name:"subscription_id",itemValue:"_id",options:e,onChange:this.handleInputChange}),l.a.createElement(N.a,{classes:"create-user-input",label:"Subscription Period",name:"subscription_mode",options:[{name:"monthly"},{name:"yearly"}],onChange:this.handleInputChange}),l.a.createElement(w.a,null,l.a.createElement("span",{className:"text-secondary cancel-link",onClick:this.props.toggle},"Cancel"),l.a.createElement(p.a,{className:"create-user",type:"submit"},this.props.Subscription.isLoading?l.a.createElement(T.a,{type:"ball-pulse-sync",color:"#fff"}):"Submit")," ")))))}}]),a}(l.a.Component),A=Object(d.connect)((function(e){return Object(n.a)({},e)}),(function(e){return{createUser:function(t){return e(Object(j.a)(t))},pay:function(t){return e(_(t))},getUsers:function(){return e(D.a)}}}))(V),J=a(838),R=function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={isOpen:!1,subscriptions:[]},e.toggle=function(){return e.setState({isOpen:!e.state.isOpen})},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){"Expired"!==Object(J.a)()&&(window.location.href="/"),this.props.getSubscription()}},{key:"render",value:function(){return l.a.createElement(c.Fragment,null,l.a.createElement(A,{subs:this.props.Subscription.subscriptions,toggle:this.toggle,modal:this.state.isOpen}),l.a.createElement("div",{className:"h-100 bg-plum-plate bg-animation"},l.a.createElement("div",{className:"d-flex h-100 justify-content-center align-items-center"},l.a.createElement(u.a,{md:"8",className:"mx-auto app-login-box"},l.a.createElement("div",{className:"app-logo-inverse mx-auto ",style:{height:"35px",backgroundRepeat:"no-repeat"}}),l.a.createElement("div",{className:"modal-dialog w-100 mx-auto",size:"lg"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("div",{className:"modal-body"},l.a.createElement("div",{className:"h5 modal-title text-center"},l.a.createElement("h4",{className:"mt-2"},l.a.createElement("div",null,"Your subscription has expired"),l.a.createElement("span",null,"Kindly make payments to continue using julla merchant portal services.")))),l.a.createElement("div",{className:"modal-footer clearfix"},l.a.createElement("div",{className:"float-left"},l.a.createElement("a",{href:"https://julla.co/pricing",target:"blank",className:"btn-lg btn btn-link"},"View Pricing")),l.a.createElement("div",{className:"float-right"},l.a.createElement(p.a,{color:"primary",size:"lg",onClick:this.toggle},"Make Payments"))))),l.a.createElement("div",{className:"text-center text-white opacity-8 mt-3"},"Copyright \xa9 Julla 2020")))))}}]),a}(c.Component),q=function(e){return{getSubscription:function(){return e(P())}}},z=function(e){return Object(n.a)({},e)};t.default=Object(d.connect)(z,q)(R)},212:function(e,t,a){"use strict";var n=a(3);t.a=function(e){return{type:n.c,payload:e}}},242:function(e,t,a){"use strict";var n=a(204),r=a.n(n),i=a(68),o=a(3),s=a(212);t.a=function(){return function(e){e(Object(s.a)());var t=JSON.parse(localStorage.getItem("user")).merchant_id;return r.a.get("https://gateway.julla.co/merchant/v1/merchants/".concat(t,"/stores")).then((function(t){var a;e((a=t.data,{type:o.O,payload:a})),localStorage.setItem("stores",JSON.stringify(t.data))})).catch((function(t){var a;i.f.error(t.response.data.message),e((a=t,{type:o.N,payload:a}))}))}}},266:function(e,t,a){"use strict";var n=a(204),r=a.n(n),i=a(68),o=a(3),s=a(212);t.a=function(){return function(e){e(Object(s.a)());var t=JSON.parse(localStorage.getItem("user")).merchant_id;return r.a.get("".concat("https://gateway.julla.co/auth/api/auth/v2","/merchant-staff/").concat(t)).then((function(t){var a;e((a=t.data,{type:o.S,payload:a})),localStorage.setItem("users",JSON.stringify(t.data))})).catch((function(t){var a;console.log(t),i.f.error(t.response.data.message),e((a=t,{type:o.R,payload:a}))}))}}},310:function(e,t,a){"use strict";var n=a(1),r=a(63),i=a(64),o=function(){function e(){Object(r.a)(this,e)}return Object(i.a)(e,null,[{key:"isEmailValid",value:function(e){return/^([a-z_.!@#$%^&*0-9]{3,25})@([a-z]{3,20})\.([a-z]){2,7}(\.[a-z]{2,5})?$/i.test(e)}},{key:"isPasswordValid",value:function(e){return/^(?=.*[0-9])([a-zA-Z0-9!@#$.%^&*~`?><,.';"|}{}+-=)()|]{8,20})$/.test(e)}},{key:"isNameValid",value:function(e){return/^([a-zA-Z]){3,20}$/.test(e)}},{key:"isPhoneValid",value:function(e){return/^\d{12}$/.test(e)}},{key:"isIdValid",value:function(e){return/^\d{8}$/.test(e)}}]),e}();t.a=function(e,t){var a=Object(n.a)({},t);switch(e.type){case"email":o.isEmailValid(e.content)?delete a.email:a.email=!0;break;case"password":o.isPasswordValid(e.content)?delete a.firstName:a.password=!0;break;case"first_name":o.isNameValid(e.content)?delete a.firstName:a.firstName=!0;break;case"last_name":o.isNameValid(e.content)?delete a.lastName:a.lastName=!0;break;case"msisdn":o.isPhoneValid(e.content)?delete a.phoneNumber:a.phoneNumber=!0;break;case"national_id":o.isIdValid(e.content)?delete a.nationalId:a.nationalId=!0;break;case"handle":o.isNameValid(e.content)?delete a.handle:a.handle=!0;break;default:return a}return a}},340:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(736),o=a(909),s=a(737),c=a(921),l=a(2),u=a.n(l);c.a.propTypes={label:u.a.string.isRequired,placeholder:u.a.string.isRequired,options:u.a.array.isRequired},t.a=function(e){var t=e.label,a=e.placeholder,n=e.options,c=e.name,l=e.onChange,u=e.itemValue;return r.a.createElement(i.a,null,r.a.createElement(o.a,{for:"exampleSelect"},t),r.a.createElement(s.a,{type:"select",name:c,id:"exampleSelect",placeholder:a,onChange:l},r.a.createElement("option",{value:"",disabled:!0,selected:!0},a),n.map((function(e){return r.a.createElement("option",{value:e[u]},e.name)}))))}},391:function(e,t,a){"use strict";var n=a(0),r=a.n(n);t.a=function(e){var t=e.classes,a=e.label,n=e.placeholder,i=e.name,o=e.type,s=e.onchange,c=e.inputValue,l=e.required,u=e.error;return r.a.createElement("div",{className:"".concat(t," 'form-group'")},r.a.createElement("label",{htmlFor:"exampleInputEmail1"},a),r.a.createElement("input",{type:o,name:i,className:"form-control","aria-describedby":"emailHelp",placeholder:n,onChange:s,value:c,required:l}),r.a.createElement("div",{className:u?"text-danger":"d-none"},"Invalid Input"))}},412:function(e,t,a){"use strict";var n=a(204),r=a.n(n),i=a(68),o=a(3);a(212);t.a=function(e){return function(t){t({type:o.c});var a=JSON.parse(localStorage.getItem("user")),n=a._id,s=a.merchant_id;return console.log(n),e.initiated_by=n,e.merchant_id=s,r.a.post("".concat("https://gateway.julla.co/auth/api/auth/v2","/merchant-staff"),e).then((function(e){var a;t((a=e.data,{type:o.q,payload:a}))})).catch((function(e){var a;console.log(e),i.f.error(e.response.data.message),t((a=e,{type:o.p,payload:a}))}))}}},742:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(0),r=a.n(n).a.createContext({})},838:function(e,t,a){"use strict";t.a=function(){var e=JSON.parse(localStorage.getItem("user")),t=new Date(e.subscription_next_due_date),a=new Date;return t<a?(console.log(t,a),console.log("Expired"),"Expired"):t>a?(console.log(t,a),console.log("Has not expired"),"Active"):void 0}},921:function(e,t,a){"use strict";var n=a(4),r=a(5),i=a(70),o=a(6),s=a(0),c=a.n(s),l=a(2),u=a.n(l),p=a(922),d=a(18),h=a.n(d),m=a(742),f=a(183),g={a11y:u.a.bool,disabled:u.a.bool,direction:u.a.oneOf(["up","down","left","right"]),group:u.a.bool,isOpen:u.a.bool,nav:u.a.bool,active:u.a.bool,addonType:u.a.oneOfType([u.a.bool,u.a.oneOf(["prepend","append"])]),size:u.a.string,tag:f.q,toggle:u.a.func,children:u.a.node,className:u.a.string,cssModule:u.a.object,inNavbar:u.a.bool,setActiveFromChild:u.a.bool},b=[f.l.space,f.l.enter,f.l.up,f.l.down,f.l.end,f.l.home],v=function(e){function t(t){var a;return(a=e.call(this,t)||this).addEvents=a.addEvents.bind(Object(i.a)(a)),a.handleDocumentClick=a.handleDocumentClick.bind(Object(i.a)(a)),a.handleKeyDown=a.handleKeyDown.bind(Object(i.a)(a)),a.removeEvents=a.removeEvents.bind(Object(i.a)(a)),a.toggle=a.toggle.bind(Object(i.a)(a)),a.containerRef=c.a.createRef(),a}Object(o.a)(t,e);var a=t.prototype;return a.getContextValue=function(){return{toggle:this.toggle,isOpen:this.props.isOpen,direction:"down"===this.props.direction&&this.props.dropup?"up":this.props.direction,inNavbar:this.props.inNavbar,disabled:this.props.disabled}},a.componentDidMount=function(){this.handleProps()},a.componentDidUpdate=function(e){this.props.isOpen!==e.isOpen&&this.handleProps()},a.componentWillUnmount=function(){this.removeEvents()},a.getContainer=function(){return this.containerRef.current},a.getMenuCtrl=function(){return this._$menuCtrl||(this._$menuCtrl=this.getContainer().querySelector("[aria-expanded]")),this._$menuCtrl},a.getMenuItems=function(){return[].slice.call(this.getContainer().querySelectorAll('[role="menuitem"]'))},a.addEvents=function(){var e=this;["click","touchstart","keyup"].forEach((function(t){return document.addEventListener(t,e.handleDocumentClick,!0)}))},a.removeEvents=function(){var e=this;["click","touchstart","keyup"].forEach((function(t){return document.removeEventListener(t,e.handleDocumentClick,!0)}))},a.handleDocumentClick=function(e){if(!e||3!==e.which&&("keyup"!==e.type||e.which===f.l.tab)){var t=this.getContainer();(!t.contains(e.target)||t===e.target||"keyup"===e.type&&e.which!==f.l.tab)&&this.toggle(e)}},a.handleKeyDown=function(e){var t=this;if(!/input|textarea/i.test(e.target.tagName)&&(f.l.tab!==e.which||"menuitem"===e.target.getAttribute("role")&&this.props.a11y)&&((-1!==b.indexOf(e.which)||e.which>=48&&e.which<=90)&&e.preventDefault(),!this.props.disabled&&(this.getMenuCtrl()===e.target&&(!this.props.isOpen&&[f.l.space,f.l.enter,f.l.up,f.l.down].indexOf(e.which)>-1?(this.toggle(e),setTimeout((function(){return t.getMenuItems()[0].focus()}))):this.props.isOpen&&e.which===f.l.esc&&this.toggle(e)),this.props.isOpen&&"menuitem"===e.target.getAttribute("role"))))if([f.l.tab,f.l.esc].indexOf(e.which)>-1)this.toggle(e),this.getMenuCtrl().focus();else if([f.l.space,f.l.enter].indexOf(e.which)>-1)e.target.click(),this.getMenuCtrl().focus();else if([f.l.down,f.l.up].indexOf(e.which)>-1||[f.l.n,f.l.p].indexOf(e.which)>-1&&e.ctrlKey){var a=this.getMenuItems(),n=a.indexOf(e.target);f.l.up===e.which||f.l.p===e.which&&e.ctrlKey?n=0!==n?n-1:a.length-1:(f.l.down===e.which||f.l.n===e.which&&e.ctrlKey)&&(n=n===a.length-1?0:n+1),a[n].focus()}else if(f.l.end===e.which){var r=this.getMenuItems();r[r.length-1].focus()}else if(f.l.home===e.which){this.getMenuItems()[0].focus()}else if(e.which>=48&&e.which<=90)for(var i=this.getMenuItems(),o=String.fromCharCode(e.which).toLowerCase(),s=0;s<i.length;s+=1){if((i[s].textContent&&i[s].textContent[0].toLowerCase())===o){i[s].focus();break}}},a.handleProps=function(){this.props.isOpen?this.addEvents():this.removeEvents()},a.toggle=function(e){return this.props.disabled?e&&e.preventDefault():this.props.toggle(e)},a.render=function(){var e,t,a=Object(f.n)(this.props,["toggle","disabled","inNavbar","a11y"]),i=a.className,o=a.cssModule,s=a.direction,l=a.isOpen,u=a.group,d=a.size,g=a.nav,b=a.setActiveFromChild,v=a.active,y=a.addonType,O=a.tag,E=Object(r.a)(a,["className","cssModule","direction","isOpen","group","size","nav","setActiveFromChild","active","addonType","tag"]),w=O||(g?"li":"div"),N=!1;b&&c.a.Children.map(this.props.children[1].props.children,(function(e){e&&e.props.active&&(N=!0)}));var k=Object(f.m)(h()(i,"down"!==s&&"drop"+s,!(!g||!v)&&"active",!(!b||!N)&&"active",((e={})["input-group-"+y]=y,e["btn-group"]=u,e["btn-group-"+d]=!!d,e.dropdown=!u&&!y,e.show=l,e["nav-item"]=g,e)),o);return c.a.createElement(m.a.Provider,{value:this.getContextValue()},c.a.createElement(p.c,null,c.a.createElement(w,Object(n.a)({},E,((t={})["string"===typeof w?"ref":"innerRef"]=this.containerRef,t),{onKeyDown:this.handleKeyDown,className:k}))))},t}(c.a.Component);v.propTypes=g,v.defaultProps={a11y:!0,isOpen:!1,direction:"down",nav:!1,active:!1,addonType:!1,inNavbar:!1,setActiveFromChild:!1},t.a=v}}]);
//# sourceMappingURL=17.703d0ee7.chunk.js.map